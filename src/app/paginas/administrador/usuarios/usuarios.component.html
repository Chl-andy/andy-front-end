<div class="container py-4">
  <h2 class="text-center mb-4 fw-bold text-secondary">Usuarios</h2>

  <button class="btn btn-primary mb-3" (click)="abrirModal()">Registrar Usuario</button>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Documento</th>
        <th>Correo</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of usuarios">
        <td>{{ u.nombre }}</td>
        <td>{{ u.apellido }}</td>
        <td>{{ u.numeroDocumento }}</td>
        <td>{{ u.correo }}</td>
        <td>
          <button class="btn btn-sm btn-info me-1" (click)="abrirModal(u)">Editar</button>
          <button class="btn btn-sm btn-danger" (click)="eliminarUsuario(u)">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal Usuario -->
<div class="modal fade" id="usuarioModal" tabindex="-1" aria-labelledby="usuarioModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow rounded-3">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="usuarioModalLabel">{{ editandoUsuario ? 'Editar Usuario' : 'Registrar Usuario' }}</h5>
        <button type="button" class="btn-close btn-close-white" (click)="cerrarModal()" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="formUsuario" (ngSubmit)="guardarUsuario()">

          <!-- Tipo de usuario solo en registro -->
          <div class="d-flex justify-content-center mb-3" *ngIf="!editandoUsuario">
            <button 
              type="button" 
              class="btn me-2"
              [ngClass]="tipoUsuarioRegistro === 'cliente' ? 'btn-primary' : 'btn-outline-primary'"
              (click)="tipoUsuarioRegistro='cliente'">
              Cliente
            </button>
            <button 
              type="button" 
              class="btn"
              [ngClass]="tipoUsuarioRegistro === 'veterinario' ? 'btn-info text-white' : 'btn-outline-info'"
              (click)="tipoUsuarioRegistro='veterinario'">
              Veterinario
            </button>
          </div>

          <!-- Línea decorativa -->
          <hr *ngIf="!editandoUsuario" [ngStyle]="{
            'border-top': '3px solid',
            'border-color': tipoUsuarioRegistro === 'cliente' ? '#0d6efd' : '#0dcaf0'
          }">

          <!-- Fila 1: Nombre y Apellido -->
          <div class="row mb-3">
            <div class="col">
              <label>Nombre</label>
              <input type="text" formControlName="nombre" class="form-control" placeholder="Ingrese su nombre">
            </div>
            <div class="col">
              <label>Apellido</label>
              <input type="text" formControlName="apellido" class="form-control" placeholder="Ingrese su apellido">
            </div>
          </div>

          <!-- Fila 2: Documento y Teléfono -->
          <div class="row mb-3">
            <div class="col">
              <label>Número de Documento</label>
              <input type="text" formControlName="numeroDocumento" class="form-control" placeholder="DNI o documento">
            </div>
            <div class="col">
              <label>Teléfono</label>
              <input type="text" formControlName="telefono" class="form-control" placeholder="Número de contacto">
            </div>
          </div>

          <!-- Fila 3: Correo y Dirección -->
          <div class="row mb-3">
            <div class="col">
              <label>Correo</label>
              <input type="email" formControlName="correo" class="form-control" placeholder="ejemplo@correo.com">
            </div>
            <div class="col">
              <label>Dirección</label>
              <input type="text" formControlName="direccion" class="form-control" placeholder="Dirección">
            </div>
          </div>

          <!-- RUC solo para veterinario -->
          <div class="mb-3" *ngIf="tipoUsuarioRegistro === 'veterinario'">
            <label>RUC</label>
            <input type="text" formControlName="ruc" class="form-control" placeholder="Ingrese su RUC">
          </div>

          <!-- Fila 4: Usuario y Contraseña -->
          <div class="row mb-4">
            <div class="col">
              <label>Nombre de usuario</label>
              <input type="text" formControlName="username" class="form-control" placeholder="Usuario para iniciar sesión">
            </div>
            <div class="col">
              <label>Contraseña</label>
              <input type="password" formControlName="password" class="form-control" placeholder="Contraseña">
            </div>
          </div>

          <button type="submit" class="btn btn-success w-100">{{ editandoUsuario ? 'Actualizar' : 'Registrar' }}</button>

        </form>
      </div>
    </div>
  </div>
</div>
